<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    

    <title>
      2016 Multi University Training Contest 1 | 留住了丶时间 
    </title>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    
      <meta name="author" content="idealism-xxm">
    
    

    <meta name="description" content="官方题解
1001. Abandoned country题目链接
题目大意给定一个无向图，找出最小生成树，并求出最小生成树所有路径长度的期望？
思路 - 最小生成树&amp;amp;&amp;amp;树形DP首先用\(Kruskal\)处理出最小生成树，并在找出所有最小生成树上的边，然后在最小生成树上DP。设边\((u,v)\)两边的点数分别为\(cnt1,cnt2\)，则这条边会被\(cnt1*cnt2\)条最">
<meta property="og:type" content="article">
<meta property="og:title" content="2016 Multi University Training Contest 1 | 留住了丶时间">
<meta property="og:url" content="http://idealism-xxm.github.io/2016/07/19/2016-Multi-University-Training-Contest 1/index.html">
<meta property="og:site_name" content="留住了丶时间">
<meta property="og:description" content="官方题解
1001. Abandoned country题目链接
题目大意给定一个无向图，找出最小生成树，并求出最小生成树所有路径长度的期望？
思路 - 最小生成树&amp;amp;&amp;amp;树形DP首先用\(Kruskal\)处理出最小生成树，并在找出所有最小生成树上的边，然后在最小生成树上DP。设边\((u,v)\)两边的点数分别为\(cnt1,cnt2\)，则这条边会被\(cnt1*cnt2\)条最">
<meta property="og:updated_time" content="2016-07-25T06:22:39.850Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="2016 Multi University Training Contest 1 | 留住了丶时间">
<meta name="twitter:description" content="官方题解
1001. Abandoned country题目链接
题目大意给定一个无向图，找出最小生成树，并求出最小生成树所有路径长度的期望？
思路 - 最小生成树&amp;amp;&amp;amp;树形DP首先用\(Kruskal\)处理出最小生成树，并在找出所有最小生成树上的边，然后在最小生成树上DP。设边\((u,v)\)两边的点数分别为\(cnt1,cnt2\)，则这条边会被\(cnt1*cnt2\)条最">
    
    
    
      <link rel="icon" type="image/x-icon" href="/images/favicon.png">
    
    <link rel="stylesheet" href="/css/uno.css">
    <link rel="stylesheet" href="/css/highlight.css">
    <link rel="stylesheet" href="/css/archive.css">
    <link rel="stylesheet" href="/css/china-social-icon.css">

</head>
<body>

    <span class="mobile btn-mobile-menu">
        <i class="icon icon-list btn-mobile-menu__icon"></i>
        <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
    </span>

    

<header class="panel-cover panel-cover--collapsed">


  <div class="panel-main">

  
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        
        <a href="/" title="link to homepage for 留住了丶时间"><img src="/images/avatar.jpg" width="80" alt="留住了丶时间 logo" class="panel-cover__logo logo" /></a>
        

        <h1 class="panel-cover__title panel-title"><a href="/" title="link to homepage">留住了丶时间</a></h1>
        <hr class="panel-cover__divider" />

        
        <p class="panel-cover__description">
          旅游即是耻辱！
        </p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />
        

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">

              
                
                <li class="navigation__item"><a href="/#blog" title="" class="blog-button">首页</a></li>
              
                
                <li class="navigation__item"><a href="/about" title="" class="">关于</a></li>
              
                
                <li class="navigation__item"><a href="/archive" title="" class="">归档</a></li>
              
                
                <li class="navigation__item"><a href="/atom.xml" title="" class="">Rss</a></li>
              
                
                <li class="navigation__item"><a href="/sitemap.xml" title="" class="">Sitemap</a></li>
              

            </ul>
          </nav>

          <!-- ----------------------------
To add a new social icon simply duplicate one of the list items from below
and change the class in the <i> tag to match the desired social network
and then add your link to the <a>. Here is a full list of social network
classes that you can use:

    icon-social-500px
    icon-social-behance
    icon-social-delicious
    icon-social-designer-news
    icon-social-deviant-art
    icon-social-digg
    icon-social-dribbble
    icon-social-facebook
    icon-social-flickr
    icon-social-forrst
    icon-social-foursquare
    icon-social-github
    icon-social-google-plus
    icon-social-hi5
    icon-social-instagram
    icon-social-lastfm
    icon-social-linkedin
    icon-social-medium
    icon-social-myspace
    icon-social-path
    icon-social-pinterest
    icon-social-rdio
    icon-social-reddit
    icon-social-skype
    icon-social-spotify
    icon-social-stack-overflow
    icon-social-steam
    icon-social-stumbleupon
    icon-social-treehouse
    icon-social-tumblr
    icon-social-twitter
    icon-social-vimeo
    icon-social-xbox
    icon-social-yelp
    icon-social-youtube
    icon-social-zerply
    icon-mail

-------------------------------->

<!-- add social info here -->



<nav class="cover-navigation navigation--social">
  <ul class="navigation">

    
      <!-- Github -->
      <li class="navigation__item">
        <a href="https://github.com/idealism-xxm" title="idealism-xxm on GitHub">
          <i class='icon icon-social-github'></i>
          <span class="label">GitHub</span>
        </a>
      </li>
    

    <li class="navigation__item">
        <a href="http://weibo.com/u/2783861260" title="故事_已到終點">
          <i class='icon cs-icon-weibo'></i>
          <span class="label">Weibo</span>
        </a>
    </li>

    <!-- China social icon -->
    <!--
    
      <li class="navigation__item">
        <a href="" title="">
          <i class='icon cs-icon-douban'></i>
          <span class="label">Douban</span>
        </a>
      </li>

      <li class="navigation__item">
        <a href="" title="">
          <i class='icon cs-icon-weibo'></i>
          <span class="label">Weibo</span>
        </a>
      </li>

    -->



  </ul>
</nav>



        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner entry">
            

<article class="post-container post-container--single">

  <header class="post-header">
    
    <h1 class="post-title">2016 Multi University Training Contest 1</h1>

    

    <div class="post-meta">
      <time datetime="2016-07-19" class="post-meta__date date">2016-07-19</time> 

      <span class="post-meta__tags tags">

          
            <font class="categories">
            &#8226; 分类:
            <a class="categories-link" href="/categories/ACM/">ACM</a>, <a class="categories-link" href="/categories/ACM/多校/">多校</a>, <a class="categories-link" href="/categories/ACM/多校/未补完/">未补完</a>, <a class="categories-link" href="/categories/ACM/多校/未补完/2016/">2016</a>
            </font>
          

          
             &#8226; 标签:
            <font class="tags">
              <a class="tags-link" href="/tags/ACM/">ACM</a>, <a class="tags-link" href="/tags/HDU/">HDU</a>, <a class="tags-link" href="/tags/RMQ/">RMQ</a>, <a class="tags-link" href="/tags/二分/">二分</a>, <a class="tags-link" href="/tags/匈牙利算法/">匈牙利算法</a>, <a class="tags-link" href="/tags/博弈论/">博弈论</a>, <a class="tags-link" href="/tags/多校/">多校</a>, <a class="tags-link" href="/tags/最小生成树/">最小生成树</a>, <a class="tags-link" href="/tags/树形DP/">树形DP</a>, <a class="tags-link" href="/tags/组合游戏/">组合游戏</a>, <a class="tags-link" href="/tags/计算几何/">计算几何</a>
            </font>
          

      </span>
    </div>
    
    

  </header>

  <section id="post-content" class="article-content post">
    <p><a href="http://bestcoder.hdu.edu.cn/blog/2016-multi-university-training-contest-1-solutions-by-hit/" title="2016 Multi-University Training Contest 1 solutions BY HIT" target="_blank" rel="external">官方题解</a></p>
<h1 id="1001-Abandoned-country"><a href="#1001-Abandoned-country" class="headerlink" title="1001. Abandoned country"></a>1001. Abandoned country</h1><p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5723" title="HDU-5724 Abandoned country" target="_blank" rel="external">题目链接</a></p>
<h2 id="题目大意"><a href="#题目大意" class="headerlink" title="题目大意"></a>题目大意</h2><p>给定一个无向图，找出最小生成树，并求出最小生成树所有路径长度的期望？</p>
<h2 id="思路-最小生成树-amp-amp-树形DP"><a href="#思路-最小生成树-amp-amp-树形DP" class="headerlink" title="思路 - 最小生成树&amp;&amp;树形DP"></a>思路 - 最小生成树&amp;&amp;树形DP</h2><p>首先用\(Kruskal\)处理出最小生成树，并在找出所有最小生成树上的边，然后在最小生成树上DP。<br>设边\((u,v)\)两边的点数分别为\(cnt1,cnt2\)，则这条边会被\(cnt1*cnt2\)条最短路径用到，最后再除以\({n*(n-1)} \over {2}\)即可。</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN=<span class="number">100005</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> INF=<span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> Node &#123;</span><br><span class="line">    <span class="keyword">int</span> e,w;</span><br><span class="line"></span><br><span class="line">    Node(<span class="keyword">int</span> ee=<span class="number">0</span>,<span class="keyword">int</span> ww=INF):e(ee),w(ww) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Node&amp; a) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> w&lt;a.w;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> Q_Node &#123;</span><br><span class="line">    <span class="keyword">int</span> s,e,w;</span><br><span class="line"></span><br><span class="line">    Q_Node(<span class="keyword">int</span> ss=<span class="number">0</span>,<span class="keyword">int</span> ee=<span class="number">0</span>,<span class="keyword">int</span> ww=INF):s(ss),e(ee),w(ww) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Q_Node&amp; a) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> w&lt;a.w;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;edge[MAXN*<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,m,s,e,w,num;</span><br><span class="line"><span class="keyword">int</span> cnt[MAXN];</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans;</span><br><span class="line"><span class="keyword">double</span> tot,tmp;</span><br><span class="line"><span class="keyword">bool</span> vis[MAXN];</span><br><span class="line"><span class="built_in">vector</span>&lt;Node&gt; g[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> par[<span class="number">100005</span>],pa,pb;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getPar</span><span class="params">(<span class="keyword">int</span> a)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(par[a]!=a)</span><br><span class="line">        par[a]=getPar(par[a]);</span><br><span class="line">    <span class="keyword">return</span> par[a];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    pa=getPar(a);</span><br><span class="line">    pb=getPar(b);</span><br><span class="line">    <span class="keyword">if</span>(pa!=pb) &#123;</span><br><span class="line">        par[pb]=pa;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Kruskal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    sort(edge,edge+m);</span><br><span class="line">    ans=num=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m&amp;&amp;num!=n;++i) &#123;</span><br><span class="line">        <span class="keyword">if</span>(getPar(edge[i].s)!=getPar(edge[i].e)) &#123;</span><br><span class="line">            Merge(edge[i].s,edge[i].e);</span><br><span class="line">            ++num;</span><br><span class="line">            ans+=edge[i].w;</span><br><span class="line">            g[edge[i].s].push_back(Node(edge[i].e,edge[i].w));</span><br><span class="line">            g[edge[i].e].push_back(Node(edge[i].s,edge[i].w));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    cnt[u]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> v;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=g[u].size()<span class="number">-1</span>;i&gt;=<span class="number">0</span>;--i) &#123;</span><br><span class="line">        v=g[u][i].e;</span><br><span class="line">        <span class="keyword">if</span>(cnt[v]==<span class="number">-1</span>) &#123;</span><br><span class="line">            DFS(v);</span><br><span class="line">            cnt[u]+=cnt[v];</span><br><span class="line">            tot+=<span class="number">1.0</span>/tmp*g[u][i].w*(n-cnt[v])*cnt[v];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios_base::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;T;</span><br><span class="line">    <span class="keyword">while</span>(T--&gt;<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) &#123;</span><br><span class="line">            g[i].clear();</span><br><span class="line">            cnt[i]=<span class="number">-1</span>;</span><br><span class="line">            par[i]=i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;++i) &#123;</span><br><span class="line">            <span class="built_in">cin</span>&gt;&gt;edge[i].s&gt;&gt;edge[i].e&gt;&gt;edge[i].w;</span><br><span class="line">        &#125;</span><br><span class="line">        Kruskal();</span><br><span class="line">        tmp=<span class="number">0.5</span>*n*(n<span class="number">-1</span>);</span><br><span class="line">        tot=<span class="number">0</span>;</span><br><span class="line">        num=<span class="number">0</span>;</span><br><span class="line">        DFS(<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">cout</span>.setf(ios::fixed);</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="string">" "</span>&lt;&lt;setprecision(<span class="number">2</span>)&lt;&lt;tot&lt;&lt;<span class="string">"\n"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="1002-Chess"><a href="#1002-Chess" class="headerlink" title="1002. Chess"></a>1002. Chess</h1><p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5724" title="HDU-5724 Chess" target="_blank" rel="external">题目链接</a></p>
<h2 id="题目大意-1"><a href="#题目大意-1" class="headerlink" title="题目大意"></a>题目大意</h2><p>给定一个\(n*20\)的棋盘，上面放着一些棋子，两个人轮流将其中一个棋子移至右边的第一个空位，第一个不能移动的人输，两个人都采取最优策略，问先手是否必胜？</p>
<h2 id="思路-博弈论"><a href="#思路-博弈论" class="headerlink" title="思路 - 博弈论"></a>思路 - 博弈论</h2><p>一眼就看出来是组合游戏，但是没学过，又一直卡在\(1001\)，最终还是没学也没写。</p>
<p>看过了\(SG函数\)后发现这也是一道简单题。<br>首先预处理出每一个状态的\(SG\)值，然后根据输入的情况直接判断即可。</p>
<h2 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">﻿<span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,m,cur,x,ans;</span><br><span class="line"><span class="keyword">int</span> sg[(<span class="number">1</span>&lt;&lt;<span class="number">20</span>)+<span class="number">7</span>];</span><br><span class="line"><span class="keyword">bool</span> vis[<span class="number">25</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN=<span class="number">1</span>&lt;&lt;<span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getSG</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(sg,<span class="number">0</span>,<span class="keyword">sizeof</span>(sg));</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;MAXN;++i) &#123;</span><br><span class="line">        <span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="keyword">sizeof</span>(vis));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">20</span>;j&gt;=<span class="number">0</span>;--j) &#123;</span><br><span class="line">            <span class="keyword">if</span>((i&amp;(<span class="number">1</span>&lt;&lt;j))!=<span class="number">0</span>) &#123;<span class="comment">//如果这一位有棋子</span></span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k=j<span class="number">-1</span>;k&gt;=<span class="number">0</span>;--k) &#123;</span><br><span class="line">                    <span class="keyword">if</span>((i&amp;(<span class="number">1</span>&lt;&lt;k))==<span class="number">0</span>) &#123;<span class="comment">//找到第一个空位置</span></span><br><span class="line">                        vis[sg[i^(<span class="number">1</span>&lt;&lt;j)^(<span class="number">1</span>&lt;&lt;k)]]=<span class="literal">true</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=<span class="number">20</span>;++j) &#123;<span class="comment">//极限情况只有一个棋子，则最多只能移动19次</span></span><br><span class="line">            <span class="keyword">if</span>(!vis[j]) &#123;</span><br><span class="line">                sg[i]=j;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    getSG();</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--&gt;<span class="number">0</span>) &#123;</span><br><span class="line">        ans=<span class="number">0</span>;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m);</span><br><span class="line">            cur=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(m--&gt;<span class="number">0</span>) &#123;</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x);</span><br><span class="line">                cur|=<span class="number">1</span>&lt;&lt;(<span class="number">20</span>-x);<span class="comment">//由于是向右移，所以是20-x</span></span><br><span class="line">            &#125;</span><br><span class="line">            ans^=sg[cur];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%s\n"</span>,ans==<span class="number">0</span>?<span class="string">"NO"</span>:<span class="string">"YES"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="1003-Game"><a href="#1003-Game" class="headerlink" title="1003. Game"></a>1003. Game</h1><p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5725" title="HDU-5725 Game" target="_blank" rel="external">题目链接</a></p>
<h2 id="题目大意-2"><a href="#题目大意-2" class="headerlink" title="题目大意"></a>题目大意</h2><p>在一个\(n*m\)的棋盘上，有一些守卫，任意守卫均不在其他守卫的同一行、同一列或者周围的八个格子内，求所有空点空点之间路径长度的平均值？</p>
<h2 id="思路"><a href="#思路" class="headerlink" title="思路 -"></a>思路 -</h2><h2 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">﻿</span><br></pre></td></tr></table></figure>
<h1 id="1004-GCD"><a href="#1004-GCD" class="headerlink" title="1004. GCD"></a>1004. GCD</h1><p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5726" title="HDU-5726 GCD" target="_blank" rel="external">题目链接</a></p>
<h2 id="题目大意-3"><a href="#题目大意-3" class="headerlink" title="题目大意"></a>题目大意</h2><p>给定\(n\)个数的数组\(a_1,a_2,…a_n\)，有\(q\)个查询，每次查询区间\([l,r]\)内所有数的最小公倍数\(gcd\)，以及最小公倍数等于\(gcd\)的所有区间个数。</p>
<h2 id="思路-RMQ-amp-amp-二分"><a href="#思路-RMQ-amp-amp-二分" class="headerlink" title="思路 - RMQ&amp;&amp;二分"></a>思路 - RMQ&amp;&amp;二分</h2><p>比赛时已经想到可以固定区间一个端点然后用二分，但是没有想到预处理，想每次查询都如此，就不知道该如何做了。</p>
<p>看了题解后发现直接可以预处理，我用了\(RMQ\)和二分，预处理复杂度为\(O(n*log^2 n\)。<br>感觉标程那个方法有点难懂。</p>
<h2 id="代码-3"><a href="#代码-3" class="headerlink" title="代码"></a>代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">﻿<span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN=<span class="number">100007</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> lg2=<span class="built_in">log</span>(<span class="number">2.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,q;</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>,<span class="keyword">long</span> <span class="keyword">long</span>&gt; cnt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> RMQ &#123;</span><br><span class="line">    <span class="keyword">int</span> gcd[MAXN][<span class="number">19</span>];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;(<span class="number">1</span>&lt;&lt;j)&lt;=n;++j) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i+(<span class="number">1</span>&lt;&lt;(j<span class="number">-1</span>))&lt;=n;++i) &#123;<span class="comment">//此处用i&lt;=n就得开两倍的第一维</span></span><br><span class="line">                gcd[i][j]=__gcd(gcd[i][j<span class="number">-1</span>],gcd[i+(<span class="number">1</span>&lt;&lt;(j<span class="number">-1</span>))][j<span class="number">-1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> k=<span class="built_in">log</span>(r-l+<span class="number">1</span>)/lg2;</span><br><span class="line">        <span class="keyword">return</span> __gcd(gcd[l][k],gcd[r-(<span class="number">1</span>&lt;&lt;k)+<span class="number">1</span>][k]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;rmq;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">binSearch</span><span class="params">(<span class="keyword">int</span> sta,<span class="keyword">int</span> key)</span> </span>&#123;<span class="comment">//反悔gcd值第一个小于key的位置</span></span><br><span class="line">    <span class="keyword">int</span> l=sta,r=n,mid;</span><br><span class="line">    <span class="keyword">while</span>(l&lt;=r) &#123;</span><br><span class="line">        mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(key&lt;=rmq.query(sta,mid)) &#123;</span><br><span class="line">            l=mid+<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            r=mid<span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> l;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T,pre,indx,gcd,kase=<span class="number">0</span>,l,r;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line">    <span class="keyword">while</span>(kase&lt;T) &#123;</span><br><span class="line">        cnt.clear();</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d:\n"</span>,++kase);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;rmq.gcd[i][<span class="number">0</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        rmq.init();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) &#123;</span><br><span class="line">            pre=i;</span><br><span class="line">            <span class="keyword">while</span>(pre&lt;=n) &#123;</span><br><span class="line">                gcd=rmq.query(i,pre);</span><br><span class="line">                indx=binSearch(i,gcd);<span class="comment">//二分搜索gcd变化的位置</span></span><br><span class="line">                cnt[gcd]+=indx-pre;</span><br><span class="line">                pre=indx;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;q);</span><br><span class="line">        <span class="keyword">while</span>(q--&gt;<span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;l,&amp;r);</span><br><span class="line">            gcd=rmq.query(l,r);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d %I64d\n"</span>,gcd,cnt[gcd]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="1005-Necklace"><a href="#1005-Necklace" class="headerlink" title="1005. Necklace"></a>1005. Necklace</h1><p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5727" title="HDU-5727 Necklace" target="_blank" rel="external">题目链接</a></p>
<h2 id="题目大意-4"><a href="#题目大意-4" class="headerlink" title="题目大意"></a>题目大意</h2><p>给定阴珠子和阳珠子各\(n\)个，再给定某些阳珠子不能和某些阴珠子放在一起，否则阳珠子会变暗，求串成一个项链时，阳珠子变暗的最少个数？</p>
<h2 id="思路-匈牙利算法"><a href="#思路-匈牙利算法" class="headerlink" title="思路 - 匈牙利算法"></a>思路 - 匈牙利算法</h2><p>先枚举阴珠子排列，然后将阳珠子插入其中，阳珠子与前后都不冲突时，建立一条边，然后用匈牙利算法进行二分图匹配，则答案就是\(min{n-cnt}\)，\(cnt\)表示二分图最大匹配数。</p>
<h2 id="代码-4"><a href="#代码-4" class="headerlink" title="代码"></a>代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,m,num[<span class="number">11</span>],s,e,ans,cnt,pre,nxt;</span><br><span class="line"><span class="keyword">int</span> match[<span class="number">11</span>];<span class="comment">//match[u]表示当前与阳珠子u匹配的阴珠子</span></span><br><span class="line"><span class="keyword">bool</span> illegal[<span class="number">11</span>][<span class="number">11</span>];<span class="comment">//illegal[i][j]表示阴珠子i不能和阳珠子j在一起</span></span><br><span class="line"><span class="keyword">bool</span> onPath[<span class="number">11</span>];<span class="comment">//onPath[u]表示结点u是否在当前增广路径上</span></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[<span class="number">11</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> v;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=g[u].size()<span class="number">-1</span>;i&gt;=<span class="number">0</span>;--i) &#123;</span><br><span class="line">        v=g[u][i];</span><br><span class="line">        <span class="keyword">if</span>(!onPath[v]) &#123;</span><br><span class="line">            onPath[v]=<span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span>(match[v]==<span class="number">0</span>||dfs(match[v])) &#123;<span class="comment">//如果阳珠子未配对或者存在以match[v]为起点的增广路径</span></span><br><span class="line">                match[v]=u;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) &#123;</span><br><span class="line">        num[i]=i;</span><br><span class="line">    &#125;</span><br><span class="line">    ans=n;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) &#123;</span><br><span class="line">            g[i].clear();</span><br><span class="line">            pre=num[i];</span><br><span class="line">            nxt=(i==n?num[<span class="number">1</span>]:num[i+<span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;++j) &#123;</span><br><span class="line">                <span class="keyword">if</span>(!illegal[pre][j]&amp;&amp;!illegal[nxt][j]) &#123;<span class="comment">//当阳珠子的前后都不冲突时才建边</span></span><br><span class="line">                    g[i].push_back(j);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        cnt=<span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(match,<span class="number">0</span>,<span class="keyword">sizeof</span>(match));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) &#123;</span><br><span class="line">            <span class="built_in">memset</span>(onPath,<span class="literal">false</span>,<span class="keyword">sizeof</span>(onPath));</span><br><span class="line">            <span class="keyword">if</span>(dfs(num[i])) &#123;</span><br><span class="line">                ++cnt;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ans=min(ans,n-cnt);</span><br><span class="line">    &#125; <span class="keyword">while</span>(next_permutation(num+<span class="number">2</span>,num+n+<span class="number">1</span>));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m)==<span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"0\n"</span>);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">memset</span>(illegal,<span class="literal">false</span>,<span class="keyword">sizeof</span>(illegal));</span><br><span class="line">        <span class="keyword">while</span>(m--&gt;<span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;s,&amp;e);</span><br><span class="line">            illegal[e][s]=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        solve();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="1009-Turn-the-pokers"><a href="#1009-Turn-the-pokers" class="headerlink" title="1009. Turn the pokers"></a>1009. Turn the pokers</h1><p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=4869" title="HDU-4869 Turn the pokers" target="_blank" rel="external">题目链接</a></p>
<h2 id="题目大意-5"><a href="#题目大意-5" class="headerlink" title="题目大意"></a>题目大意</h2><h2 id="思路-组合数"><a href="#思路-组合数" class="headerlink" title="思路 - 组合数"></a>思路 - 组合数</h2><h2 id="代码-5"><a href="#代码-5" class="headerlink" title="代码"></a>代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN=<span class="number">200005</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MOD=<span class="number">1e9</span>+<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">quick_pow</span><span class="params">(LL a, LL b)</span> </span>&#123;</span><br><span class="line">    LL ans = <span class="number">1</span>;</span><br><span class="line">    a %= MOD;<span class="comment">//防止指数为0时，返回未取模的结果</span></span><br><span class="line">    <span class="keyword">while</span>(b!=<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>((b &amp; <span class="number">1</span>)==<span class="number">1</span>) &#123;</span><br><span class="line">            ans = ans * a % MOD;</span><br><span class="line">        &#125;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        a = a * a % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LL fac[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">C</span><span class="params">(LL n,LL m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n&lt;m||m&lt;<span class="number">0</span>||n==<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    LL s1=fac[n],s2=fac[n-m]*fac[m]%MOD;</span><br><span class="line">    <span class="keyword">return</span> s1*quick_pow(s2,MOD<span class="number">-2</span>)%MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    fac[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;MAXN;++i) &#123;</span><br><span class="line">        fac[i]=(fac[i<span class="number">-1</span>]*i)%MOD;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,m,x,l,r,ll,rr;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">2</span>==<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m)) &#123;</span><br><span class="line">        l=r=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(n--&gt;<span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x);</span><br><span class="line">            <span class="keyword">if</span>(l&gt;=x) &#123;<span class="comment">//l&gt;=x时，可以将x个1变为0，则1的个数的最小值变为l-x</span></span><br><span class="line">                ll=l-x;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(r&gt;=x)&#123;<span class="comment">//l&lt;x&lt;=r时，由于1的个数可以取l,l+2,l+4,...,r-2,r，则l与x奇偶性相同时，可以得到1的个数最小值为0；否则会多翻一次，即1的个数的最小值为1</span></span><br><span class="line">                ll=(x-l)%<span class="number">2</span>==<span class="number">0</span>?<span class="number">0</span>:<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;<span class="comment">//r&lt;x时，将所有的r个1变为0，剩余的x-r个0变为1，则1的个数的最小值为x-r</span></span><br><span class="line">                ll=x-r;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(r+x&lt;=m) &#123;<span class="comment">//r+x&lt;=m时，可以将x个0变为1，则1的个数的最大值变为r+x</span></span><br><span class="line">                rr=r+x;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(l+x&lt;=m) &#123;<span class="comment">//l+x&lt;=m&lt;r+x时，由于1的个数可以取r,r-2,r-4,...,l+2,l，则l+x与m奇偶性相同时，可以得到1的个数最大值为m；否则会多翻一次，即1的个数的最大值为m-1</span></span><br><span class="line">                rr=(m-l-x)%<span class="number">2</span>==<span class="number">0</span>?m:m<span class="number">-1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;<span class="comment">//m&lt;l+x时，将所有的m-l个0变为1，剩余的l+x-m个1变为0，则1的个数的最大值为m-l+m-x</span></span><br><span class="line">                rr=m-l+m-x;</span><br><span class="line">            &#125;</span><br><span class="line">            l=ll;</span><br><span class="line">            r=rr;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(l&lt;=r) &#123;</span><br><span class="line">            ans=(ans+C(m,l))%MOD;</span><br><span class="line">            l+=<span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%I64d\n"</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="1011-tetrahedron"><a href="#1011-tetrahedron" class="headerlink" title="1011. tetrahedron"></a>1011. tetrahedron</h1><p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5733" title="HDU-5733 tetrahedron" target="_blank" rel="external">题目链接</a></p>
<h2 id="题目大意-6"><a href="#题目大意-6" class="headerlink" title="题目大意"></a>题目大意</h2><p>计算四面体内切球球心和半径。</p>
<h2 id="思路-计算几何"><a href="#思路-计算几何" class="headerlink" title="思路 - 计算几何"></a>思路 - 计算几何</h2><p>模版题。</p>
<h2 id="代码-6"><a href="#代码-6" class="headerlink" title="代码"></a>代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/***********基础*************/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> EPS=<span class="number">0.000001</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> Point_3D &#123;</span><br><span class="line">    <span class="keyword">double</span> x, y, z;</span><br><span class="line">    Point_3D(<span class="keyword">double</span> xx = <span class="number">0</span>, <span class="keyword">double</span> yy = <span class="number">0</span>, <span class="keyword">double</span> zz = <span class="number">0</span>): x(xx), y(yy), z(zz) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> == (<span class="keyword">const</span> Point_3D&amp; A) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x==A.x &amp;&amp; y==A.y &amp;&amp; z==A.z;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;Vector_3D;</span><br><span class="line"></span><br><span class="line"><span class="function">Point_3D <span class="title">read_Point_3D</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> x,y,z;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lf%lf%lf"</span>,&amp;x,&amp;y,&amp;z);</span><br><span class="line">    <span class="keyword">return</span> Point_3D(x,y,z);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Vector_3D <span class="keyword">operator</span> + (<span class="keyword">const</span> Vector_3D &amp; A, <span class="keyword">const</span> Vector_3D &amp; B) &#123;</span><br><span class="line">    <span class="keyword">return</span> Vector_3D(A.x + B.x, A.y + B.y, A.z + B.z);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Vector_3D <span class="keyword">operator</span> - (<span class="keyword">const</span> Point_3D &amp; A, <span class="keyword">const</span> Point_3D &amp; B) &#123;</span><br><span class="line">    <span class="keyword">return</span> Vector_3D(A.x - B.x, A.y - B.y, A.z - B.z);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Vector_3D <span class="keyword">operator</span> * (<span class="keyword">const</span> Vector_3D &amp; A, <span class="keyword">double</span> p) &#123;</span><br><span class="line">    <span class="keyword">return</span> Vector_3D(A.x * p, A.y * p, A.z * p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Vector_3D <span class="keyword">operator</span> / (<span class="keyword">const</span> Vector_3D &amp; A, <span class="keyword">double</span> p) &#123;</span><br><span class="line">    <span class="keyword">return</span> Vector_3D(A.x / p, A.y / p, A.z / p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Dot</span><span class="params">(<span class="keyword">const</span> Vector_3D &amp; A, <span class="keyword">const</span> Vector_3D &amp; B)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> A.x * B.x + A.y * B.y + A.z * B.z;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Length</span><span class="params">(<span class="keyword">const</span> Vector_3D &amp; A)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sqrt</span>(Dot(A, A));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Angle</span><span class="params">(<span class="keyword">const</span> Vector_3D &amp; A, <span class="keyword">const</span> Vector_3D &amp; B)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">acos</span>(Dot(A, B) / Length(A) / Length(B));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Vector_3D <span class="title">Cross</span><span class="params">(<span class="keyword">const</span> Vector_3D &amp; A, <span class="keyword">const</span> Vector_3D &amp; B)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Vector_3D(A.y * B.z - A.z * B.y, A.z * B.x - A.x * B.z, A.x * B.y - A.y * B.x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Area2</span><span class="params">(<span class="keyword">const</span> Point_3D &amp; A, <span class="keyword">const</span> Point_3D &amp; B, <span class="keyword">const</span> Point_3D &amp; C)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Length(Cross(B - A, C - A));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Volume6</span><span class="params">(<span class="keyword">const</span> Point_3D &amp; A, <span class="keyword">const</span> Point_3D &amp; B, <span class="keyword">const</span> Point_3D &amp; C, <span class="keyword">const</span> Point_3D &amp; D)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Dot(D - A, Cross(B - A, C - A));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//判断四点是否共面</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isOnPlane</span><span class="params">(<span class="keyword">const</span> Point_3D&amp; a,<span class="keyword">const</span> Point_3D&amp; b,<span class="keyword">const</span> Point_3D&amp; c,<span class="keyword">const</span> Point_3D&amp; d)</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> t = Dot(d-a,Cross(b-a, c-a));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-0.000001</span>&lt;=t&amp;&amp;t&lt;=<span class="number">0.000001</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 四面体的重心</span></span><br><span class="line"><span class="function">Point_3D <span class="title">Centroid</span><span class="params">(<span class="keyword">const</span> Point_3D &amp; A, <span class="keyword">const</span> Point_3D &amp; B, <span class="keyword">const</span> Point_3D &amp; C, <span class="keyword">const</span> Point_3D &amp; D)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (A + B + C + D) / <span class="number">4.0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/************点线面*************/</span></span><br><span class="line"><span class="comment">// 点p到平面p0-n的距离。n必须为单位向量</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">DistanceToPlane</span><span class="params">(<span class="keyword">const</span> Point_3D &amp; p, <span class="keyword">const</span> Point_3D &amp; p0, <span class="keyword">const</span> Vector_3D &amp; n)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">fabs</span>(Dot(p - p0, n)); <span class="comment">// 如果不取绝对值，得到的是有向距离</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 点p在平面p0-n上的投影。n必须为单位向量</span></span><br><span class="line"><span class="function">Point_3D <span class="title">GetPlaneProjection</span><span class="params">(<span class="keyword">const</span> Point_3D &amp; p, <span class="keyword">const</span> Point_3D &amp; p0, <span class="keyword">const</span> Vector_3D &amp; n)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> p - n * Dot(p - p0, n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//直线p1-p2 与平面p0-n的交点</span></span><br><span class="line"><span class="function">Point_3D <span class="title">LinePlaneIntersection</span><span class="params">(Point_3D p1, Point_3D p2, Point_3D p0, Vector_3D n)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    Vector_3D v= p2 - p1;</span><br><span class="line">    <span class="keyword">double</span> t = (Dot(n, p0 - p1) / Dot(n, p2 - p1)); <span class="comment">//分母为0，直线与平面平行或在平面上</span></span><br><span class="line">    <span class="keyword">return</span> p1 + v * t; <span class="comment">//如果是线段 判断t是否在0~1之间</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 点P到直线AB的距离</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">DistanceToLine</span><span class="params">(<span class="keyword">const</span> Point_3D &amp; P, <span class="keyword">const</span> Point_3D &amp; A, <span class="keyword">const</span> Point_3D &amp; B)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    Vector_3D v1 = B - A, v2 = P - A;</span><br><span class="line">    <span class="keyword">return</span> Length(Cross(v1, v2)) / Length(v1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//点到线段的距离</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">DistanceToSeg</span><span class="params">(Point_3D p, Point_3D a, Point_3D b)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(a == b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> Length(p - a);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Vector_3D v1 = b - a, v2 = p - a, v3 = p - b;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(Dot(v1, v2) + EPS &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> Length(v2);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(Dot(v1, v3) - EPS &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> Length(v3);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> Length(Cross(v1, v2)) / Length(v1);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//求异面直线 p1+s*u与p2+t*v的公垂线对应的s 如果平行|重合，返回false</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">LineDistance3D</span><span class="params">(Point_3D p1, Vector_3D u, Point_3D p2, Vector_3D v, <span class="keyword">double</span> &amp; s)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> b = Dot(u, u) * Dot(v, v) - Dot(u, v) * Dot(u, v);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">abs</span>(b) &lt;= EPS)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">double</span> a = Dot(u, v) * Dot(v, p1 - p2) - Dot(v, v) * Dot(u, p1 - p2);</span><br><span class="line">    s = a / b;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// p1和p2是否在线段a-b的同侧</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">SameSide</span><span class="params">(<span class="keyword">const</span> Point_3D &amp; p1, <span class="keyword">const</span> Point_3D &amp; p2, <span class="keyword">const</span> Point_3D &amp; a, <span class="keyword">const</span> Point_3D &amp; b)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Dot(Cross(b - a, p1 - a), Cross(b - a, p2 - a)) - EPS &gt;= <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 点P在三角形P0, P1, P2中</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">PointInTri</span><span class="params">(<span class="keyword">const</span> Point_3D &amp; P, <span class="keyword">const</span> Point_3D &amp; P0, <span class="keyword">const</span> Point_3D &amp; P1, <span class="keyword">const</span> Point_3D &amp; P2)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> SameSide(P, P0, P1, P2) &amp;&amp; SameSide(P, P1, P0, P2) &amp;&amp; SameSide(P, P2, P0, P1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 三角形P0P1P2是否和线段AB相交</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">TriSegIntersection</span><span class="params">(<span class="keyword">const</span> Point_3D &amp; P0, <span class="keyword">const</span> Point_3D &amp; P1, <span class="keyword">const</span> Point_3D &amp; P2, <span class="keyword">const</span> Point_3D &amp; A, <span class="keyword">const</span> Point_3D &amp; B, Point_3D &amp; P)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    Vector_3D n = Cross(P1 - P0, P2 - P0);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">abs</span>(Dot(n, B - A)) &lt;= EPS)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;    <span class="comment">// 线段A-B和平面P0P1P2平行或共面</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>   <span class="comment">// 平面A和直线P1-P2有惟一交点</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">double</span> t = Dot(n, P0 - A) / Dot(n, B - A);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(t + EPS &lt; <span class="number">0</span> || t - <span class="number">1</span> - EPS &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;    <span class="comment">// 不在线段AB上</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        P = A + (B - A) * t; <span class="comment">// 交点</span></span><br><span class="line">        <span class="keyword">return</span> PointInTri(P, P0, P1, P2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//空间两三角形是否相交</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">TriTriIntersection</span><span class="params">(Point_3D * T1, Point_3D * T2)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    Point_3D P;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(TriSegIntersection(T1[<span class="number">0</span>], T1[<span class="number">1</span>], T1[<span class="number">2</span>], T2[i], T2[(i + <span class="number">1</span>) % <span class="number">3</span>], P))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(TriSegIntersection(T2[<span class="number">0</span>], T2[<span class="number">1</span>], T2[<span class="number">2</span>], T1[i], T1[(i + <span class="number">1</span>) % <span class="number">3</span>], P))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//空间两直线上最近点对 返回最近距离 点对保存在ans1 ans2中</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">SegSegDistance</span><span class="params">(Point_3D a1, Point_3D b1, Point_3D a2, Point_3D b2, Point_3D&amp; ans1, Point_3D&amp; ans2)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    Vector_3D v1 = (a1 - b1), v2 = (a2 - b2);</span><br><span class="line">    Vector_3D N = Cross(v1, v2);</span><br><span class="line">    Vector_3D ab = (a1 - a2);</span><br><span class="line">    <span class="keyword">double</span> ans = Dot(N, ab) / Length(N);</span><br><span class="line">    Point_3D p1 = a1, p2 = a2;</span><br><span class="line">    Vector_3D d1 = b1 - a1, d2 = b2 - a2;</span><br><span class="line">    <span class="keyword">double</span> t1, t2;</span><br><span class="line">    t1 = Dot((Cross(p2 - p1, d2)), Cross(d1, d2));</span><br><span class="line">    t2 = Dot((Cross(p2 - p1, d1)), Cross(d1, d2));</span><br><span class="line">    <span class="keyword">double</span> dd = Length((Cross(d1, d2)));</span><br><span class="line">    t1 /= dd * dd;</span><br><span class="line">    t2 /= dd * dd;</span><br><span class="line">    ans1 = (a1 + (b1 - a1) * t1);</span><br><span class="line">    ans2 = (a2 + (b2 - a2) * t2);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">fabs</span>(ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断P是否在三角形A, B, C中，并且到三条边的距离都至少为mindist。保证P, A, B, C共面</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">InsideWithMinDistance</span><span class="params">(<span class="keyword">const</span> Point_3D &amp; P, <span class="keyword">const</span> Point_3D &amp; A, <span class="keyword">const</span> Point_3D &amp; B, <span class="keyword">const</span> Point_3D &amp; C, <span class="keyword">double</span> mindist)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!PointInTri(P, A, B, C))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(DistanceToLine(P, A, B) &lt; mindist)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(DistanceToLine(P, B, C) &lt; mindist)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(DistanceToLine(P, C, A) &lt; mindist)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断P是否在凸四边形ABCD（顺时针或逆时针）中，并且到四条边的距离都至少为mindist。保证P, A, B, C, D共面</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">InsideWithMinDistance</span><span class="params">(<span class="keyword">const</span> Point_3D &amp; P, <span class="keyword">const</span> Point_3D &amp; A, <span class="keyword">const</span> Point_3D &amp; B, <span class="keyword">const</span> Point_3D &amp; C, <span class="keyword">const</span> Point_3D &amp; D, <span class="keyword">double</span> mindist)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!PointInTri(P, A, B, C))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!PointInTri(P, C, D, A))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(DistanceToLine(P, A, B) &lt; mindist)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(DistanceToLine(P, B, C) &lt; mindist)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(DistanceToLine(P, C, D) &lt; mindist)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(DistanceToLine(P, D, A) &lt; mindist)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*************凸包相关问题*******************/</span></span><br><span class="line"><span class="comment">//加干扰</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">rand01</span><span class="params">()</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> rand() / (<span class="keyword">double</span>)RAND_MAX;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">randeps</span><span class="params">()</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (rand01() - <span class="number">0.5</span>) * EPS;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Point_3D <span class="title">add_noise</span><span class="params">(<span class="keyword">const</span> Point_3D &amp; p)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Point_3D(p.x + randeps(), p.y + randeps(), p.z + randeps());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> Face</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> v[<span class="number">3</span>];</span><br><span class="line">    Face(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span><br><span class="line">    &#123;</span><br><span class="line">        v[<span class="number">0</span>] = a;</span><br><span class="line">        v[<span class="number">1</span>] = b;</span><br><span class="line">        v[<span class="number">2</span>] = c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Vector_3D <span class="title">Normal</span><span class="params">(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;Point_3D&gt; &amp; P)</span> <span class="keyword">const</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Cross(P[v[<span class="number">1</span>]] - P[v[<span class="number">0</span>]], P[v[<span class="number">2</span>]] - P[v[<span class="number">0</span>]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// f是否能看见P[i]</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">CanSee</span><span class="params">(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;Point_3D&gt; &amp; P, <span class="keyword">int</span> i)</span> <span class="keyword">const</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Dot(P[i] - P[v[<span class="number">0</span>]], Normal(P)) &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 增量法求三维凸包</span></span><br><span class="line"><span class="comment">// 注意：没有考虑各种特殊情况（如四点共面）。实践中，请在调用前对输入点进行微小扰动</span></span><br><span class="line"><span class="built_in">vector</span>&lt;Face&gt; CH3D(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;Point_3D&gt; &amp; P)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> n = P.size();</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &gt; vis(n);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        vis[i].resize(n);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">vector</span>&lt;Face&gt; cur;</span><br><span class="line">    cur.push_back(Face(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>)); <span class="comment">// 由于已经进行扰动，前三个点不共线</span></span><br><span class="line">    cur.push_back(Face(<span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">3</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;Face&gt; next;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 计算每条边的“左面”的可见性</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; cur.size(); j++)</span><br><span class="line">        &#123;</span><br><span class="line">            Face &amp; f = cur[j];</span><br><span class="line">            <span class="keyword">int</span> res = f.CanSee(P, i);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(!res)</span><br><span class="line">            &#123;</span><br><span class="line">                next.push_back(f);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">3</span>; k++)</span><br><span class="line">            &#123;</span><br><span class="line">                vis[f.v[k]][f.v[(k + <span class="number">1</span>) % <span class="number">3</span>]] = res;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; cur.size(); j++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">3</span>; k++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> a = cur[j].v[k], b = cur[j].v[(k + <span class="number">1</span>) % <span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(vis[a][b] != vis[b][a] &amp;&amp; vis[a][b]) <span class="comment">// (a,b)是分界线，左边对P[i]可见</span></span><br><span class="line">                &#123;</span><br><span class="line">                    next.push_back(Face(a, b, i));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        cur = next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> cur;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> ConvexPolyhedron</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">vector</span>&lt;Point_3D&gt; P, P2;</span><br><span class="line">    <span class="built_in">vector</span>&lt;Face&gt; faces;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">read</span><span class="params">()</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) != <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        P.resize(n);</span><br><span class="line">        P2.resize(n);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            P[i] = read_Point_3D();</span><br><span class="line">            P2[i] = add_noise(P[i]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        faces = CH3D(P2);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//三维凸包重心</span></span><br><span class="line">    <span class="function">Point_3D <span class="title">centroid</span><span class="params">()</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">        Point_3D C = P[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">double</span> totv = <span class="number">0</span>;</span><br><span class="line">        <span class="function">Point_3D <span class="title">tot</span><span class="params">(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; faces.size(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            Point_3D p1 = P[faces[i].v[<span class="number">0</span>]], p2 = P[faces[i].v[<span class="number">1</span>]], p3 = P[faces[i].v[<span class="number">2</span>]];</span><br><span class="line">            <span class="keyword">double</span> v = -Volume6(p1, p2, p3, C);</span><br><span class="line">            totv += v;</span><br><span class="line">            tot = tot + Centroid(p1, p2, p3, C) * v;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> tot / totv;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//凸包重心到表面最近距离</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">mindist</span><span class="params">(Point_3D C)</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> ans = <span class="number">1e30</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; faces.size(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            Point_3D p1 = P[faces[i].v[<span class="number">0</span>]], p2 = P[faces[i].v[<span class="number">1</span>]], p3 = P[faces[i].v[<span class="number">2</span>]];</span><br><span class="line">            ans = min(ans, <span class="built_in">fabs</span>(-Volume6(p1, p2, p3, C) / Area2(p1, p2, p3)));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Point_3D p[<span class="number">5</span>],o;</span><br><span class="line"><span class="keyword">double</span> s[<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">3</span>==<span class="built_in">scanf</span>(<span class="string">"%lf%lf%lf"</span>,&amp;p[<span class="number">1</span>].x,&amp;p[<span class="number">1</span>].y,&amp;p[<span class="number">1</span>].z)) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=<span class="number">4</span>;++i) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lf%lf%lf"</span>,&amp;p[i].x,&amp;p[i].y,&amp;p[i].z);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(isOnPlane(p[<span class="number">1</span>],p[<span class="number">2</span>],p[<span class="number">3</span>],p[<span class="number">4</span>])) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"O O O O\n"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            o.x=o.y=o.z=<span class="number">0</span>;</span><br><span class="line">            s[<span class="number">1</span>]=Area2(p[<span class="number">2</span>],p[<span class="number">3</span>],p[<span class="number">4</span>]);</span><br><span class="line">            s[<span class="number">2</span>]=Area2(p[<span class="number">1</span>],p[<span class="number">3</span>],p[<span class="number">4</span>]);</span><br><span class="line">            s[<span class="number">3</span>]=Area2(p[<span class="number">2</span>],p[<span class="number">1</span>],p[<span class="number">4</span>]);</span><br><span class="line">            s[<span class="number">4</span>]=Area2(p[<span class="number">2</span>],p[<span class="number">3</span>],p[<span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">4</span>;++i) &#123;</span><br><span class="line">                o.x+=s[i]*p[i].x;</span><br><span class="line">                o.y+=s[i]*p[i].y;</span><br><span class="line">                o.z+=s[i]*p[i].z;</span><br><span class="line">            &#125;</span><br><span class="line">            o.x/=(s[<span class="number">1</span>]+s[<span class="number">2</span>]+s[<span class="number">3</span>]+s[<span class="number">4</span>]);</span><br><span class="line">            o.y/=(s[<span class="number">1</span>]+s[<span class="number">2</span>]+s[<span class="number">3</span>]+s[<span class="number">4</span>]);</span><br><span class="line">            o.z/=(s[<span class="number">1</span>]+s[<span class="number">2</span>]+s[<span class="number">3</span>]+s[<span class="number">4</span>]);</span><br><span class="line">            Vector_3D sn=Cross(p[<span class="number">1</span>]-p[<span class="number">2</span>],p[<span class="number">1</span>]-p[<span class="number">3</span>]);</span><br><span class="line">            sn=sn/Length(sn);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%.4lf %.4lf %.4lf %.4lf\n"</span>,o.x,o.y,o.z,DistanceToPlane(o,p[<span class="number">1</span>],sn));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
  </section>

  
  

<section class="post-comments">

    <div class="ds-thread" data-thread-key="2016/07/19/2016-Multi-University-Training-Contest 1/"></div>

    <script type="text/javascript">
      var duoshuoQuery = {short_name:"idealism-xxm"};
      (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
        || document.getElementsByTagName('body')[0]).appendChild(ds);
      })();
    </script> 

</section>


</article>


            <footer class="footer">

    <span class="footer__copyright">&copy; 2014-2015. | 由<a href="https://hexo.io/">Hexo</a>强力驱动 | 主题<a href="https://github.com/someus/huno">Huno</a></span>
    
</footer>
        </div>
    </div>

    <!-- js files -->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/main.js"></script>
    <script src="/js/scale.fix.js"></script>
    

    

    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript"> 
        $(document).ready(function(){
            MathJax.Hub.Config({ 
                tex2jax: {inlineMath: [['[latex]','[/latex]'], ['\\(','\\)']]} 
            });
        });
    </script>


    

    <script src="/js/awesome-toc.min.js"></script>
    <script>
        $(document).ready(function(){
            $.awesome_toc({
                overlay: true,
                contentId: "post-content",
            });
        });
    </script>


    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-79149014-1', 'auto');
  ga('send', 'pageview');

</script>
    

    <script src="/js/jquery.githubRepoWidget.min.js"></script>


    <!--kill ie6 -->
<!--[if IE 6]>
  <script src="//letskillie6.googlecode.com/svn/trunk/2/zh_CN.js"></script>
<![endif]-->

</body>
</html>
